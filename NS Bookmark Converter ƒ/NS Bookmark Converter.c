/* #Includes */#include "NS Bookmark Converter.h"/* Main Procedure */void main(void){	InitToolbox();		DoGestalt();		EventInit();		EventLoop();}	/* Calls Gestalt() to make sure certain features are present */void DoGestalt(void){	OSErr	err;	long	feature;		err=Gestalt(gestaltAppleEventsAttr, &feature);	if(err!=noErr)		ProcessError("\pProblem calling Gestalt!", (long)err, 1);		if(!(feature & (kGestaltMask << gestaltAppleEventsPresent)))		ProcessError("\pAppleEvents not available!", NIL, 2);			err=Gestalt(gestaltFSAttr, &feature);	if(err!=noErr)		ProcessError("\pProblem calling Gestalt!", (long)err, 7);			if(!(feature & (kGestaltMask << gestaltHasFSSpecCalls)))		ProcessError("\pFSSpec's not available!", NIL, 8);			err=Gestalt(gestaltStandardFileAttr, &feature);	if(err!=noErr)		ProcessError("\pProblem calling Gestalt!", (long)err, 3);			if(!(feature & (kGestaltMask << gestaltStandardFile58)))		ProcessError("\pStandard File Package not supported!", NIL, 4);}/* Installs UPP's for the Core AppleEvents */void EventInit(void){	/* Local Variables */	OSErr	err;		OAPPHandlerUPP=NewAEEventHandlerProc(DoOpenApp);	err=AEInstallEventHandler(kCoreEventClass, kAEOpenApplication, OAPPHandlerUPP, NIL, false);	if(err!=noErr)		ProcessError("\pProblem installing AppleEvent handler!", (long)err, 723);			ODOCHandlerUPP=NewAEEventHandlerProc(DoOpenDoc);	err=AEInstallEventHandler(kCoreEventClass, kAEOpenDocuments, ODOCHandlerUPP, NIL, false);	if(err!=noErr)		ProcessError("\pProblem installing AppleEvent handler!", (long)err, 724);			PDOCHandlerUPP=NewAEEventHandlerProc(DoPrintDoc);	err=AEInstallEventHandler(kCoreEventClass, kAEPrintDocuments, PDOCHandlerUPP, NIL, false);	if(err!=noErr)		ProcessError("\pProblem installing AppleEvent handler!", (long)err, 725);			QUITHandlerUPP=NewAEEventHandlerProc(DoQuitApp);	err=AEInstallEventHandler(kCoreEventClass, kAEQuitApplication, QUITHandlerUPP, NIL, false);	if(err!=noErr)		ProcessError("\pProblem installing AppleEvent handler!", (long)err, 723);}/* Main event loop */void EventLoop(void){	/* Local Variables */	EventRecord event;	Point		diskLoc;		while(gDone==false)	{		WaitNextEvent(everyEvent, &event, kSleep, NIL);				switch(event.what)		{			case kHighLevelEvent:				AEProcessAppleEvent(&event);			break;						case diskEvt:				if(HiWord(event.message)!=noErr)				{					diskLoc.h=diskLoc.v=50;					DILoad();					DIBadMount(diskLoc, event.message);					DIUnload();				}			break;		}	}}