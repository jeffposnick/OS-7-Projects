/* Preferences Realted Stuff */struct Preferences{	short	quitOnClose;	short	autoConvert;	short	vRefNum;	long	dirID;	Str63	name;	short	hour;	short	minute;	short	amPm;	short	day;};typedef struct Preferences Preferences;enum{	kDontConvert=0,	kConvert,	kDontQuit=0,	kQuit};/* Linked list for FSSpecs and strings */struct ListType{	FSSpec			theSpec;	Str255			theURL;	struct ListType	*next;};typedef struct ListType ListType;/* Globals */Boolean		gFlag=true, gDone=false, gDialogPresent=false;DateTimeRec	gDateTime;DialogPtr	gDialog;ListType	*gStart;Preferences	gPreferences, gDefaultPrefs;short		gAppResNum, gPrefsResNum;/* #Define kFatalAlertID first, then #include the supplementary header */#define kFatalAlertID	129#include "Header.h"/* Internet Config Stuff *//* You can get the needed files from <ftp://redback.cs.uwa.edu.au//Others/Quinn/Config/> (it's in that directory, and it should be called something like "ICProgKit") *//* Be sure to add the appropriate .lib or .o file to your project before you compile */#include "ICKeys.h"#include "ICTypes.h"#include "ICAPI.h"#include "ICCAPI.h"ICInstance	gInst;/* Constants */#define kAppleMenuItems		'DRVR'#define kNetscapeCreator	'MOSS'#define kAnarchieCreator	'Arch'#define kAnarchieType		'ALST'#define kAnarchieURLType	'AURL'#define kTeachTextCreator	'ttxt'#define kSleep				360#define kEmptyString		"\p"#define kEnableButton		0#define kDisableButton		255#define kTEXTID				256#define kPrefsFileName		"\pURL Clerk Prefs"#define kPrefsType			'drPf'#define kPrefsFileType		'pref'#define kPrompt				"\pPlease Choose A Location:"#define kDefaultFileName	"\pNew URL"#define kDefaultText		"\p<No File Selected>"#define kMoreDefaultText	"\p<None>"#define kExportMessage		"\pCreated with URL Clerk"#define kJunk				-9999#define kJunkText			"\p123 ....><bd¬î‚«äþ«þÎ"#define kNewChar			'-'#define kYahooSearch		"\phttp://search.yahoo.com/bin/search?p=*"#define kLycosSearch		"\phttp://www.lycos.com/cgi-bin/pursuit?cat=lycos&query=*"#define kExciteSearch		"\phttp://www.excite.com/search.gw?c=web&search=*&trace=a&x=29&y=27"#define kInfoSeekSearch		"\phttp://www.infoseek.com/Titles?qt=*&col=UG&sv=IS&lk=noframes&nh=10"#define kKey				"\p*"/* IDs */enum{	kMenuBarID=128,	kAboutBoxID=128,	kScheduleDialogID=128,	kCreateURLDialogID,	kEditURLDialogID,	kEnterSearchDialogID,	kSearchDialogID,	kExportDialogID,	kSearchOnWebDialogID,	kStringID=128,	kPrefsID=128};/* Menus */enum{	mApple=128,	mFile,	mEdit};/* Menu Items */enum{ 	iAbout=1,	iNew=1,	iOpen,	iExtractURL=4,	iExportURL,	iEdit=7,	iFind,	iFindWebSite,	iSchedule,	iQuit=12,	iPaste=5,	iToggleQuit=8,	iAutoConvert=9};/* Popup Menu Items */enum{ 	pEveryHour=14,	pEvery5Minutes=14,	pAM=1,	pPM=2,	pAmPm=4,	pYahoo=1,	pInfoSeek,	pExcite,	pLycos};enum{	pSunday=1,	pMonday,	pTuesday,	pWednesday,	pThursday,	pFriday,	pSaturday,	pWeekday=9,	pWeekend,	pEveryDay};enum{	pAny=1,	pHttp=3,	pFtp,	pMail,	pTelnet,	pNews,	pGopher,	pNone};enum{	pReturn=1,	pTab,	pSpace};/* Dialog Items */enum{	dExport=1,	dLaunch=1,	dSearch=1,	dFindNext=1,	dOK=1,	dCancel,	dDone=2,	dSearchText,	dLaunchURL=3,	dDelimeter=3,	dURL,	dNameOfFile=4,	dSourceFolder=4,	dSave,	dURLFound=5,	dExportFile=5,	dChooseFile=5,	dClear,	dIncludeName=6,	dPopupType=6,	dURLType=6,	dFileName,	dHour,	dMinute,	dAmPm,	dDay};/* Prototypes */void main(void);void DoGestalt(void);void MakeMenus(void);void DoPreferences(void);void EventInit(void);pascal OSErr DoOpenApp(AppleEvent *theAppleEvent, AppleEvent *reply, long refCon);pascal OSErr DoOpenDoc(AppleEvent *theAppleEvent, AppleEvent *reply, long refCon);pascal OSErr DoPrintDoc(AppleEvent *theAppleEvent, AppleEvent *reply, long refCon);pascal OSErr DoQuitApp(AppleEvent *theAppleEvent, AppleEvent *reply, long refCon);short DoCreatePrefs(void);void DoCopyResource(short dest);Ptr GetURLAsPtr(FSSpec spec);void GetURLAsStr255(FSSpec spec, Str255 *theURL);void DoLaunchURLInFile(FSSpec spec);void DoTouch(FSSpec spec);void DoChangeCreator(FSSpec spec);short GetURLType(FSSpec theSpec);void ICInit(void);void EventLoop(void);void HandleMenuChoice(long menuChoice);Boolean CheckTime(void);Boolean CheckHour(int hour);Boolean CheckMinute(int minute);void DoCreateURL(void);void DoOpenURL(void);void DoExtractURL(void);Handle HandleEMail(Handle theURL);void GetName(Handle theURL, Str63 name);void ChangeColon(Str63 fileName);void PutURL(FSSpec theLocation, Handle theURLHandle);void WriteToFile(FSSpec theFile, Ptr theURL);void DoExportURL(void);void DoWriteExport(FSSpec spec, short vRefNum, long dirID, char delim, Boolean includeName, long count, short refNum, Boolean isFirst);void DoEditURL(void);void DoFind(void);void SearchInFolder(short refNum, long dirID, Str255 theString, short urlType);void MoreSearching(short refNum, long dirID, Str255 theString, short urlType);void GetRidOfList(void);void AddToMyList(FSSpec theSpec, Str255 theURL);Boolean GetCurItem(Str255 *url, Str255 *fileName);void SearchInFile(FSSpec theSpec, Str255 theString, Str255 *returnString, short urlType);Boolean StringInString(short pos, Str255 source, Str255 search);void DoSearchOnWeb(void);void DoSearchURLSynth(short engine, Str255 theString);void DoSchedule(void);void ChooseFile(StandardFileReply *reply);void ChooseFileExtended(StandardFileReply *reply);void ChangeToColon(Str255 theString);void ChangeFromColon(Str255 theString);void CopyPString(StringPtr source, StringPtr dest);void CopyPtr(Ptr source, Ptr dest);void PtrToStr255(long length, Ptr thePtr, Str255 theString);Ptr Str255ToPtr(Str255 theString);void DoQuit(void);extern pascal OSErr FSpDTSetComment(const FSSpec *spec, ConstStr255Param comment);extern pascal OSErr	FSpDTGetComment(const FSSpec *spec, Str255 comment);extern pascal OSErr FSpGetDirectoryID(const FSSpec *spec, long *dirID, Boolean *isDirectory);extern pascal OSErr	GetDirName(short vRefNum, long dirID, StringPtr name);extern pascal OSErr GetDirItems(short vRefNum, long dirID, StringPtr name, Boolean getFiles, Boolean getDirectories, FSSpecPtr items, short reqItemCount, short *actItemCount, short *itemIndex);